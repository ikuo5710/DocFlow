# プロダクト要求定義書 (Product Requirements Document)

## プロダクト概要

### 名称
**DocFlow** - AI-Friendly Document Converter

### プロダクトコンセプト
- **AIフレンドリーな形式への変換**: 紙文書、PDF、画像をAIが処理しやすいマークダウン形式に変換し、AIとの協働を促進
- **人間とAIの協働によるOCR品質向上**: OCR結果を人間が確認・編集しながら、AI支援機能で効率的に高品質なテキストデータを作成
- **並列ビューアによる効率的な作業**: 元ファイルとOCR結果を並べて表示することで、確認・編集作業を効率化

### プロダクトビジョン
DocFlowは、紙文書やPDFのデジタル化を通じて、個人ユーザーがAIを活用しやすい環境を構築することを目指す。
OCR処理の結果を人間とAIが協働で改善することで、高品質なマークダウンデータを効率的に生成する。
シンプルで直感的なインターフェースにより、デジタル化の心理的障壁を下げ、個人の知識資産のデジタル化を促進する。

### 目的
- 紙文書やPDFのデジタル化を促進し、個人の知識資産を整理可能にする
- OCR結果の品質を人間とAIの協働により向上させる
- AIが活用しやすいマークダウン形式でのデータ蓄積を実現する
- 学習資料や業務文書の個人的な整理を支援する

## ターゲットユーザー

### プライマリーペルソナ: 佐藤花子(35歳、ナレッジワーカー)
- 職業: フリーランスのコンサルタント、またはリモートワーク中心の会社員
- 技術レベル: 一般的なデスクトップアプリケーション(Word、Excel、PDF閲覧ソフト)を使いこなせるレベル
- 現在の課題:
  - 紙の書類や資料が溜まっており、デジタル化したいが手間がかかる
  - PDFをテキスト化したいが、既存のOCRツールは精度が低く、手作業での修正が大変
  - ChatGPTやClaude等のAIツールに文書を読み込ませたいが、画像やPDFでは精度が低い
- 期待する解決策:
  - 簡単な操作でPDFや画像をマークダウン形式に変換できる
  - OCR結果を確認しながら、必要な部分だけ手作業で修正できる
  - AI機能で誤認識を自動修正してくれる
- 1日の典型的なワークフロー:
  - 午前: クライアントとのミーティング、資料作成
  - 午後: 過去の資料や書籍を参照しながらレポート作成
  - 夕方: AIツールを使って文書の要約や分析を実施

## 成功指標(KPI)

### プライマリーKPI
- **月次アクティブユーザー(MAU)**: 50人(3ヶ月後)、200人(6ヶ月後)
  - 測定方法: アプリケーション起動時の匿名利用統計(ユーザーの同意を得た場合のみ)
- **OCR処理完了率**: 80%以上
  - 定義: OCR処理を開始したファイルのうち、最後まで処理を完了(保存まで実行)した割合
- **1ユーザーあたりの月間処理ページ数**: 平均20ページ以上
  - 定義: アクティブユーザーが1ヶ月間に処理したページ数の平均値

### セカンダリーKPI
- **AI支援機能の利用率**: 60%以上
  - 定義: OCR処理を実行したユーザーのうち、AI誤認識修正またはマークダウン構造化機能を使用した割合
- **ユーザー満足度**: 4.0/5.0以上
  - 測定方法: アプリ内フィードバック機能による任意評価

## 機能要件

### コア機能(MVP)

#### 1. ファイル入力

**ユーザーストーリー**:
個人ユーザーとして、デジタル化したい紙文書やPDFを簡単に読み込むために、ドラッグ&ドロップまたはファイル選択でファイルを入力したい

**受け入れ条件**:
- [ ] PDF形式のファイルを読み込める(複数ページ対応)
- [ ] 画像形式のファイルを読み込める(JPEG、PNG対応)
- [ ] 複数の画像ファイルを一度に読み込める
- [ ] ドラッグ&ドロップでのファイル入力に対応
- [ ] ファイル選択ダイアログでの入力に対応
- [ ] 読み込んだファイルのプレビューを表示できる

**優先度**: P0(必須)

#### 2. OCR処理

**ユーザーストーリー**:
個人ユーザーとして、読み込んだファイルを高精度でテキスト化するために、Mistral OCR APIを使ったOCR処理を実行したい

**受け入れ条件**:
- [ ] Mistral OCR API(`mistral-ocr-latest`モデル)と連携してOCR処理を実行できる
- [ ] OCR処理の進捗状況を表示できる(処理中のページ番号、全体の進捗率)
- [ ] OCR結果をマークダウン形式で取得できる
- [ ] API呼び出しのエラーハンドリングが実装されている(ネットワークエラー、API制限エラー等)
- [ ] APIキーは設定ファイルまたは環境変数で安全に管理できる

**優先度**: P0(必須)

#### 3. 並列ビューア

**ユーザーストーリー**:
個人ユーザーとして、OCR結果を確認しながら編集するために、元のファイルとOCR結果を並べて表示したい

**受け入れ条件**:
- [ ] 左ペインに元ファイル(PDFまたは画像)を表示できる
- [ ] 右ペインにOCR結果(マークダウン)を表示できる
- [ ] 左右のペインサイズを調整できる(ドラッグでリサイズ)
- [ ] PDFの場合、ページ単位で表示できる
- [ ] 画像の場合、ファイル単位で表示できる
- [ ] 表示倍率を調整できる(拡大・縮小)

**優先度**: P0(必須)

#### 4. ページ/ファイル送り機能

**ユーザーストーリー**:
個人ユーザーとして、複数ページのPDFや複数の画像ファイルを効率的に処理するために、ページ送り・ファイル送り機能を使いたい

**受け入れ条件**:
- [ ] PDFの場合、次のページ・前のページに移動できる
- [ ] 画像の場合、次のファイル・前のファイルに移動できる
- [ ] ページ/ファイル送りを実行すると、左右のペインが同期して表示される
- [ ] キーボードショートカット(矢印キーまたはPageUp/PageDown)でページ送りできる
- [ ] 現在のページ番号/ファイル番号と全体数が表示される(例: "3/10ページ")

**優先度**: P0(必須)

#### 5. 基本的なマークダウン編集

**ユーザーストーリー**:
個人ユーザーとして、OCR結果の誤認識を修正するために、マークダウンテキストを直接編集したい

**受け入れ条件**:
- [ ] 右ペインのマークダウンテキストを編集できる
- [ ] 編集内容がリアルタイムで反映される
- [ ] 基本的なテキスト編集機能(コピー、カット、ペースト、元に戻す、やり直し)が使える
- [ ] マークダウンのシンタックスハイライトが表示される
- [ ] 編集中の変更を保存前に破棄できる(編集前の状態に戻せる)

**優先度**: P0(必須)

#### 6. ファイル保存

**ユーザーストーリー**:
個人ユーザーとして、編集したマークダウンテキストを保存するために、ファイル保存機能を使いたい

**受け入れ条件**:
- [ ] マークダウンファイル(.md形式)として保存できる
- [ ] 保存先のディレクトリを選択できる
- [ ] ファイル名を指定できる(デフォルトは元ファイル名+"_ocr.md")
- [ ] 元ファイルとの関連付け情報を保存できる(メタデータとして)
- [ ] 保存成功時に確認メッセージを表示する

**優先度**: P0(必須)

### 将来的な機能(Post-MVP)

#### 7. AI誤認識修正機能

**ユーザーストーリー**:
個人ユーザーとして、OCR結果の誤認識を効率的に修正するために、AIによる自動修正機能を使いたい

**受け入れ条件**:
- [ ] AI(Mistral API等)を使って誤認識箇所を自動検出できる
- [ ] 修正提案を一覧表示できる
- [ ] 提案を個別に承認・却下できる
- [ ] 一括適用機能がある

**優先度**: P1(重要)

#### 8. マークダウン構造化機能

**ユーザーストーリー**:
個人ユーザーとして、OCR結果を読みやすいマークダウンにするために、見出しやリストの構造を自動認識・整形したい

**受け入れ条件**:
- [ ] 見出しレベルを自動認識できる
- [ ] リスト(箇条書き、番号付きリスト)を自動整形できる
- [ ] 表を認識してマークダウン形式に整形できる
- [ ] 整形結果のプレビューを表示できる

**優先度**: P1(重要)

#### 9. バッチ処理機能

複数ファイルを一括でOCR処理し、個別に確認・編集する機能。
個人ユーザーが大量の書類をまとめてデジタル化したい場合に有用。

**優先度**: P2(できれば)

#### 10. 設定機能の充実

APIキーの設定、デフォルト保存先、キーボードショートカットのカスタマイズ等。

**優先度**: P2(できれば)

## 非機能要件

### パフォーマンス
- **ファイル読み込み**: 10MBのPDFファイルを3秒以内に読み込んで表示できる
- **ページ送り**: 大量ページ(100ページ以上)のPDFでも、ページ送り操作が1秒以内に完了する
- **OCR処理**: 1ページあたり5秒以内にOCR処理を完了する(Mistral API側の処理時間に依存)
- **編集レスポンス**: マークダウンエディタのキー入力に対して、50ms以内に画面に反映される

### ユーザビリティ
- **新規ユーザーの学習時間**: 初めて使うユーザーが10分以内に基本操作(ファイル読み込み→OCR処理→編集→保存)を習得できる
- **直感的なUI**: 主要機能がメニューやツールバーから1クリックでアクセスできる
- **キーボードショートカット**: ページ送り、保存等の頻繁に使う操作はキーボードショートカットに対応
- **エラーメッセージ**: エラーが発生した場合、原因と対処法を明確に表示する

### 信頼性
- **データ損失ゼロ**: 編集中のデータを自動保存し、アプリケーションがクラッシュしても復元できる
- **エラーハンドリング**: ネットワークエラー、API制限エラー、ファイル読み込みエラー等に対して適切なエラーハンドリングを実装
- **ロールバック**: OCR処理中にエラーが発生した場合、処理前の状態に戻せる

### セキュリティ
- **APIキーの安全な保存**: Mistral APIキーは暗号化して保存し、環境変数または設定ファイルで管理
- **ローカル処理**: OCR処理以外はローカルで実行し、ユーザーのファイルをクラウドにアップロードしない
- **プライバシー**: 利用統計の収集は匿名化し、ユーザーの同意を得た場合のみ実施

### スケーラビリティ
- **大量ページ対応**: 100ページ以上のPDFでもメモリ使用量が1GB以内に収まる
- **複数ファイル対応**: 10ファイル以上の画像を同時に読み込んでもパフォーマンスが低下しない

### プラットフォーム
- **クロスプラットフォーム**: Windows、Mac、Linuxで動作する(Electronを使用)
- **Node.jsバージョン**: Node.js v24.12.0以降
- **Electronバージョン**: Electron 39.0.0以降

## スコープ外

明示的にスコープ外とする項目:
- クラウドストレージ連携機能(Google Drive、Dropbox等)
- マルチユーザー対応(チーム機能、共有機能)
- オフラインOCR機能(Tesseract等のローカルOCRエンジン)
- 出力フォーマットの拡張(HTML、DOCX等)
- モバイルアプリ版(iOS、Android)
- Webアプリケーション版
- リアルタイム協働編集機能
- バージョン管理機能(Git連携等)
